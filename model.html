<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  </head>
</head>

<style>
  /* .main-wrapper{

    overflow-x: auto;
  
  }
  .steps-wrapper{
    display: flex;
    overflow-x: hidden;
  }
  .step{
    min-width: 100%;
  } */
</style>
<body>


  <!-- <div class="main-wrapper">
    <form action="" method="post">
      <div class="steps-wrapper">
        <div class="step" id="step1">
          <h1>1</h1>
          <button class="next" type="button">Next</button>

        </div>
        <div class="step" id="step2">
          <h1>2</h1>
          <button class="next" type="button">Next</button>
          <button class="back" type="button">Previous</button>
        </div>
        <div class="step" id="step3">
          <h1>3</h1>
          <button class="back" type="button">Previous</button>
          <button class="submit" type="submit">Submit</button>
        </div>
      </div>
    </form>
  </div> -->



  <div class="stepper container formContainer">
    <div class="stepper-line"></div>
    <div class="progress-bar" id="progressBar"></div>
    <div class="step-number active">1</div>
    <div class="step-number">2</div>
    <div class="step-number">3</div>
    <div class="step-number">4</div>
  </div>

  <div id="multi-step-form">
    <div class="container wrapper formContainer col-sm-12 step active-step">
      <h1>hi</h1>

      <div class="input-data button-group mt-5">
        <button class="rn-btn edu-btn w-50 btn-next" style="align-self: center;" type="button">Next</button>
      </div>
      
    </div>
    <div class="container wrapper formContainer col-sm-12 step ">
      <h1>hi</h1>

        <div class="row mb-4 button-group justify-content-between mt-5">
          <button type="button" class="rn-btn edu-btn w-25 btn-prev">Previous</button>
          <button class="rn-btn edu-btn w-25 btn-next" type="button">Next</button>
        </div>


    </div>
    <div class="container wrapper formContainer col-sm-12 step ">
      <h1>hi</h1>

        <div class="row mb-4 button-group justify-content-between mt-5">
          <button type="button" class="rn-btn edu-btn w-25 btn-prev">Previous</button>
          <button class="rn-btn edu-btn w-25 btn-next" type="button">Next</button>
        </div>


    </div>
    <div class="container wrapper formContainer col-sm-12 step ">
      <h1>hi</h1>

      <div class="row mb-4 button-group justify-content-between mt-5">
        <button type="button" class="rn-btn edu-btn w-25 btn-prev">Previous</button>
        <button type="submit" class="rn-btn edu-btn w-25 btn-submit">Submit</button>
      </div>


    </div>
  </div>

  <script>
    // $(".next").click(function(){
    //   console.log("next button clicked");
    //   var scrollWidth= $(".step").width();
    //   var wrapperPos= $(".steps-wrapper").scrollLeft();
    //   console.log("Scroll width: "+scrollWidth+" scroll Position: "+wrapperPos);
    //   $(".steps-wrapper").animate({
    //     scrollLeft:wrapperPos + scrollWidth
    //   },200);
    // })

    // $(".back").click(function () {
    //     console.log("back button clicked");
    //     var scrollWidth = $(".step").width();
    //     var wrapperPos = $(".steps-wrapper").scrollLeft();
    //     console.log("Scroll Width: " +scrollWidth+ "scroll Position:" + wrapperPos);
    //     $(".steps-wrapper").animate({
    //       scrollLeft: wrapperPos - scrollWidth
    //     }, 200);
    //   })



    const Stepper = (() => {
        const DOM = {
          steps: document.querySelectorAll(".step") || [],
          nextButtons: document.querySelectorAll(".btn-next") || [],
          prevButtons: document.querySelectorAll(".btn-prev") || [],
          stepNumbers: document.querySelectorAll(".step-number") || [],
          progressBar: document.getElementById("progressBar") || document.createElement("div")
        };

        // Check for initially active step
        let currentStepIndex = Array.from(DOM.steps).findIndex(step => step.classList.contains("active-step"));
        currentStepIndex = currentStepIndex >= 0 ? currentStepIndex : 0;

        const totalSteps = DOM.steps.length;
        const progressStep = totalSteps > 1 ? 100 / (totalSteps - 1) : 0;

        document.addEventListener("click", (event) => {
          if (event.target.closest(".btn-next")) handleNext();
          if (event.target.closest(".btn-prev")) handlePrev();
        });

        const handleNext = () => {
          if (validateStep() && currentStepIndex < totalSteps - 1) {
            currentStepIndex++;
            updateDisplay();
          }
        };

        const handlePrev = () => {
          if (currentStepIndex > 0) {
            currentStepIndex--;
            updateDisplay();
          }
        };

        const updateDisplay = () => {
          requestAnimationFrame(() => {
            DOM.steps.forEach((step, i) => {
              step.classList.toggle("active-step", i === currentStepIndex);
              step.setAttribute("aria-hidden", i !== currentStepIndex);
            });

            DOM.stepNumbers.forEach((step, i) => {
              const active = i <= currentStepIndex;
              step.classList.toggle("active", active);
              step.setAttribute("aria-current", i === currentStepIndex);
            });

            // Ensure progress is between 0 and 100
            const progress = Math.min(Math.max(currentStepIndex * progressStep, 0), 100);
            DOM.progressBar.style.width = `${progress}%`;
          });
        };

        const validateStep = () => {
          let allValid = true;
          const inputs = DOM.steps[currentStepIndex]?.querySelectorAll("input") || [];

          inputs.forEach(input => {
            const isValid = input.checkValidity();
            input.classList.toggle("input-invalid", !isValid);
          });

          return allValid;
        };

        updateDisplay();

        return {
          goToStep: (index) => {
            if (index >= 0 && index < totalSteps) {
              currentStepIndex = index;
              updateDisplay();
            }
          },
          currentStep: () => currentStepIndex
        };
      })();


  </script>
</body>
</html>